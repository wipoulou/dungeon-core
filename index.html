<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>Dungeon Core — Playable Prototype</title>
  <link rel="stylesheet" href="style.css">
</head>
<body>
  <div id="app">
  <aside class="panel">
      <h1>Dungeon Core</h1>
      <div class="stats">
        <div><strong>Mana:</strong> <span id="mana">0</span></div>
        <div><strong>Tick:</strong> <span id="tick">0</span></div>
        <div><strong>Political Risk:</strong> <span id="political">0</span></div>
        <div><strong>Economic Pressure:</strong> <span id="economic">0</span></div>
        <div><strong>Guard Tension:</strong> <span id="tension">Calm</span></div>
      </div>

      <h2>Build</h2>
      <div class="toolbar">
        <button data-tool="room">Room (5)</button>
        <button data-tool="mob">Mob (15)</button>
        <button data-tool="trap">Trap (20)</button>
        <button data-tool="loot">Loot Node (10)</button>
        <button data-tool="erase">Erase</button>
      </div>


      <h2>Cult</h2>
      <div class="cult">
        <div id="cult-offer">No offer.</div>
        <button id="cult-accept" disabled>Accept</button>
        <button id="cult-decline" disabled>Decline</button>
      </div>
  <!-- Debug and Logs moved to footer tabs -->
    </aside>

    <main>
      <canvas id="grid" width="768" height="512"></canvas>
      <div class="legend">
        <span class="legend-item"><span class="legend-swatch room"></span>Room</span>
        <span class="legend-item"><span class="legend-swatch wall"></span>Wall</span>
        <span class="legend-item"><span class="legend-swatch mob"></span>Mob</span>
        <span class="legend-item"><span class="legend-swatch trap"></span>Trap</span>
        <span class="legend-item"><span class="legend-swatch loot"></span>Loot</span>
        <span class="legend-item"><span class="legend-swatch entrance"></span>Entrance</span>
        <span class="legend-item"><span class="legend-swatch exit"></span>Teleporter</span>
        <span class="legend-item"><span class="legend-swatch adventurer"></span>Adventurer</span>
      </div>

      <div class="footer">
        <div class="tabbar" role="tablist" aria-label="Footer Tabs">
          <div class="tabbar-left">
            <button class="tab active" role="tab" aria-selected="true" data-tab="logs" id="tab-logs">Logs</button>
            <button class="tab" role="tab" aria-selected="false" data-tab="debug" id="tab-debug">Debug</button>
          </div>
          <div class="tabbar-right sim-controls" aria-label="Simulation Controls">
            <button id="start" class="sim-btn btn-start" title="Start (▶)">▶</button>
            <button id="pause" class="sim-btn btn-pause" title="Pause (⏸)">⏸</button>
            <button id="step" class="sim-btn btn-step" title="Step (⏭)">⏭</button>
            <button id="reset" class="sim-btn btn-reset" title="Reset (⟲)">⟲</button>
          </div>
        </div>
        <div class="tabpanes">
          <div class="tabpanel active" role="tabpanel" data-tab="logs" id="pane-logs">
            <div id="log" class="log"></div>
          </div>
          <div class="tabpanel" role="tabpanel" data-tab="debug" id="pane-debug">
            <div class="debug">
              <label style="display:block; margin-bottom:6px;"><input type="checkbox" id="overlayToggle"> Show party map</label>
              <div class="row" style="display:flex; gap:6px; align-items:center; margin-bottom:6px;">
                <label for="partySelect">Party:</label>
                <select id="partySelect"></select>
                <button id="cycleParty">Cycle</button>
                <button id="clearMemory">Clear Memory</button>
                <button id="forgetSelected">Forget Selected</button>
              </div>
              <label style="display:block; margin-bottom:6px;"><input type="checkbox" id="highlightToggle" checked> Highlight selected party</label>
              <div id="partyInspector" class="log" style="max-height: 220px; overflow:auto;"></div>
            </div>
          </div>
        </div>
      </div>
    </main>
  </div>
  <script>
    // Simple tab switcher for footer
    document.addEventListener('DOMContentLoaded', () => {
      const tabs = Array.from(document.querySelectorAll('.tabbar .tab'));
      const panes = Array.from(document.querySelectorAll('.tabpanel'));
      tabs.forEach(tab => tab.addEventListener('click', () => {
        const id = tab.dataset.tab;
        tabs.forEach(t => t.classList.toggle('active', t === tab));
        panes.forEach(p => p.classList.toggle('active', p.dataset.tab === id));
      }));
    });
  </script>
  <script type="module" src="main.js"></script>
</body>
</html>
